package kkrawc6Proj7;

import java.awt.Color;


public class Island {

	private GridDisplay disp;
	private Beetle[][] grid;
	private Ant[][] secgrid;
	private int dayCount;
	private int rows;
	private int cols; 

	public Island ()
	{
		rows = 20;
		cols = 20;

		disp = new GridDisplay(rows, cols);
		grid = new Beetle[rows][cols];
		secgrid = new Ant[rows][cols];

		for (int i = 0 ; i < rows ; i++){
			for (int j = 0 ; j < cols ; j++)
				grid[i][j] = null;
		}

		for (int i = 0 ; i < rows ; i++){
			for (int j = 0 ; j < cols ; j++)
				secgrid[i][j] = null;
		}

		dayCount = 0;
	}

	public int getRows()
	{
		return rows;
	}

	public int getCols()
	{
		return cols;
	}
	public boolean isOccupiedBeetle (int i, int j)
	{
		if (i<0 || j<0 || i>19 || j>19 || grid[i][j] == null)
			return false;
		else
			return true;
	}
	public boolean isOccupiedAnt (int i, int j)
	{
		if(i<0 || j<0 || i>19 || j>19 || secgrid[i][j] == null){
			return false;
		}

		else
			return true;
	}

	public boolean isOccupied (int i, int j)
	{
		if(i<0 || j<0 || i>19 || j>19){
			return false;
		}

		if (grid[i][j] == null  && secgrid[i][j] == null)
			return false;
		else
			return true;
	}

	public void nextDayBeetle()
	{
		//dayCount++;

		// loop through the grid positions
		for (int i = 0 ; i < rows ; i++)
			for (int j = 0 ; j < cols ; j++)
			{
				// System.out.println (i + " " + j + ", " + grid[i][j] != null );

				// make sure grid location contains a Beetle and the Beetle has not moved this day
				if ( (isOccupiedBeetle(i,j) == true)  && (grid[i][j].getnotMoving() != dayCount) )
				{
					// System.out.println (i + " " + j + ", " + grid[i][j].getDayLastMoved() );

					// Access the Beetle at this position and try to move it
					Beetle b = grid[i][j];
					if(hunting(i,j) == true){
						hunt(i,j);
						b.ate();
						if(b.getdaysSinceSpawn()>8 && spawning(i,j)){
							b.spawn();
							b.spawned();
						}
						else{
							b.notSpawned();; //increment days since spawn 
						}

					}
					else{
						if(b.getdaysSinceSpawn()>8 && spawning(i,j)){
							b.spawn();
							b.spawned();
						}
						else{
							b.notSpawned(); //increment days since spawn 
						}

						if (b.getnotEaten()>8){
							die(i,j);
						}
						b.didNotEat();
						b.move();
						b.setnotMoving (dayCount);
						b.aliveAnotherDay();;
					}
				}
			}
	}
	public void nextDayAnt()
	{
		dayCount++;
		System.out.println ("DayCount: " + dayCount);

		for (int i = 0 ; i < rows ; i++)
			for (int j = 0 ; j < cols ; j++)
			{
				// System.out.println (i + " " + j + ", " + grid[i][j] != null );

				// make sure grid location contains a Beetle and the Beetle has not moved this day

				if ( (isOccupiedAnt(i,j) == true)  && (secgrid[i][j].getnotMoving() != dayCount) )
				{
					// System.out.println (i + " " + j + ", " + grid[i][j].getDayLastMoved() );

					// Access the Beetle at this position and try to move it
					Ant a = secgrid[i][j];
					if(a.getage()%3 ==0 && a.getage()!=0){
						a.breed();
					}
					a.move();
					a.setnotMoving(dayCount);
					a.aliveAnotherDay();

				}

			}
	}


	public boolean addBeetle (Beetle b, int x, int y)
	{
		// make sure x and y are valid
		if (x < 0 || x >= rows || y < 0 || y >= cols)
			return false;

		// make sure no Beetle is already at that space
		if ( isOccupied(x, y) == true)
			return false;

		grid[x][y] = b;
		disp.setColor (x, y, Color.BLACK);
		return true;
	}


	public boolean addAnt (Ant a, int x, int y)
	{
		// make sure x and y are valid
		if (x < 0 || x >= rows || y < 0 || y >= cols)
			return false;

		// make sure no Beetle is already at that space
		if ( isOccupied(x, y) == true)
			return false;

		secgrid[x][y] = a;
		disp.setColor (x, y, Color.BLUE);
		return true;
	}
	public boolean moveBeetle (int currX, int currY, int nextX, int nextY)
	{
		// make sure x and y positions are both valid
		if (currX < 0 || currX >= rows || currY < 0 || currY >= cols)
			return false;
		if (nextX < 0 || nextX >= rows || nextY < 0 || nextY >= cols)
			return false;

		// make sure a Beetle exists at the CURR space
		if ( isOccupied(currX, currY) == false)
			return false;
		// make sure no Beetle is already at the NEXT space
		if ( isOccupied(nextX, nextY) == true)
			return false;

		// move the Beetle to the new position
		grid[nextX][nextY] = grid[currX][currY];
		grid[currX][currY] = null;

		// update the GridDisplay colors to show the Beetle has moved
		disp.setColor(nextX,nextY, Color.BLACK);
		disp.setColor(currX,currY, Color.WHITE);
		return true;
	}

	public boolean moveAnt (int currX, int currY, int nextX, int nextY)
	{
		// make sure x and y positions are both valid
		if (currX < 0 || currX >= rows || currY < 0 || currY >= cols)
			return false;
		if (nextX < 0 || nextX >= rows || nextY < 0 || nextY >= cols)
			return false;

		// make sure a Beetle exists at the CURR space
		if ( isOccupied(currX, currY) == false)
			return false;
		// make sure no Beetle is already at the NEXT space
		if ( isOccupied(nextX, nextY) == true)
			return false;

		// move the Beetle to the new position
		secgrid[nextX][nextY] = secgrid[currX][currY];
		secgrid[currX][currY] = null;

		// update the GridDisplay colors to show the Beetle has moved
		disp.setColor(nextX,nextY, Color.BLUE);
		disp.setColor(currX,currY, Color.WHITE);
		return true;
	}

	public boolean spawning(int x, int y)
	{
		// make sure x and y positions are both valid
		if(isOccupied(x+1,y) && isOccupied(x-1,y) &&
				isOccupied(x,y+1) && isOccupied(x,y-1))
			return false;

		else return true;

	}
	public void hunt(int x, int y){
		if(isOccupiedAnt(x-1,y)){
			secgrid[x-1][y] = null;
			moveBeetle(x, y, x-1, y);
		}


		if(isOccupiedAnt(x+1,y)){
			secgrid[x+1][y] = null;
			moveBeetle(x, y, x+1, y);
		}


		if(isOccupiedAnt(x,y-1)){
			secgrid[x][y-1] = null;
			moveBeetle(x, y, x, y-1);		
		}

		if(isOccupiedAnt(x,y+1)){
			secgrid[x][y+1] = null;
			moveBeetle(x, y, x, y+1);		

		}
		else return;
	}
	public void die(int i, int j){
		grid[i][j]=null;
	}


	public boolean hunting(int x, int y){
		if(isOccupiedAnt(x-1,y) || isOccupiedAnt(x+1,y) ||
				isOccupiedAnt(x, y+1) || isOccupiedAnt(x,y-1)){
			return true;
		}
		return false; 
	}

}
